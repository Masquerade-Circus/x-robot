//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZXJpYWxpemVfZXhwb3J0cyIsIl9fZXhwb3J0Iiwic2VyaWFsaXplIiwiX19FWFBPUlRTX18iLCJpc1ZhbGlkU3RyaW5nIiwic3RyIiwidHJpbSIsImxlbmd0aCIsImlzVmFsaWRPYmplY3QiLCJvYmoiLCJpc1Byb2R1Y2VyIiwicHJvZHVjZXIiLCJjbG9uZUNvbnRleHQiLCJjb250ZXh0Iiwid2Vha01hcCIsIldlYWtNYXAiLCJoYXMiLCJnZXQiLCJyZXN1bHQiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJpdGVtIiwia2V5IiwiRGF0ZSIsImdldFRpbWUiLCJTZXQiLCJNYXAiLCJSZWdFeHAiLCJzb3VyY2UiLCJmbGFncyIsImFycmF5IiwiZnJvbSIsInZhbCIsInNldCIsInNlcmlhbGl6ZVByb2R1Y2VyIiwic2VyaWFsaXplZCIsIm5hbWUiLCJ0cmFuc2l0aW9uIiwiaXNQcm9kdWNlcldpdGhUcmFuc2l0aW9uIiwic2VyaWFsaXplUnVuQXJndW1lbnRzIiwicnVuIiwiYWN0aW9uIiwic3VjY2VzcyIsImZhaWx1cmUiLCJzZXJpYWxpemVBY3Rpb24iLCJzZXJpYWxpemVHdWFyZHMiLCJndWFyZHMiLCJndWFyZCIsIm1hY2hpbmUiLCJzZXJpYWxpemVHdWFyZCIsInNlcmlhbGl6ZVRyYW5zaXRpb24iLCJ0YXJnZXQiLCJzZXJpYWxpemVJbW1lZGlhdGUiLCJpbW1lZGlhdGUiLCJzZXJpYWxpemVUcmFuc2l0aW9ucyIsImV2ZW50cyIsIk9iamVjdCIsImtleXMiLCJldmVudCIsInNlcmlhbGl6ZUNvbnRleHQiLCJzZXJpYWxpemVOZXN0ZWQiLCJuZXN0ZWQiLCJzZXJpYWxpemVkTmVzdGVkTWFjaGluZSIsInN0YXRlcyIsInBhcmFsbGVsIiwiaW5pdGlhbCIsInRpdGxlIiwic3RhdGUiLCJvbiIsInNlcmlhbGl6ZWRJbW1lZGlhdGUiLCJpbW1lZGlhdGVEaXJlY3RpdmUiLCJwdXNoIiwidHlwZSIsImRlc2NyaXB0aW9uIl0sInNvdXJjZXMiOlsiLi4vLi4vbGliL3NlcmlhbGl6ZS9pbmRleC50cyIsIi4uLy4uL2xpYi91dGlscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBtb2R1bGUgeC1yb2JvdC9zZXJpYWxpemVcbiAqIEBkZXNjcmlwdGlvbiBTZXJpYWxpemVzIGEgbWFjaGluZSB0byBhIEpTT04gb2JqZWN0XG4gKiAqL1xuXG5pbXBvcnQge1xuICBBY3Rpb25EaXJlY3RpdmUsXG4gIEd1YXJkRGlyZWN0aXZlLFxuICBHdWFyZHNEaXJlY3RpdmUsXG4gIEltbWVkaWF0ZURpcmVjdGl2ZSxcbiAgTWFjaGluZSxcbiAgTmVzdGVkR3VhcmREaXJlY3RpdmUsXG4gIE5lc3RlZE1hY2hpbmVEaXJlY3RpdmUsXG4gIFByb2R1Y2VyRGlyZWN0aXZlLFxuICBSdW5Db2xsZWN0aW9uLFxuICBUcmFuc2l0aW9uRGlyZWN0aXZlLFxuICBUcmFuc2l0aW9uc0RpcmVjdGl2ZSxcbn0gZnJvbSBcIi4uL21hY2hpbmUvaW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgY2xvbmVDb250ZXh0LCBpc0FjdGlvbiwgaXNQcm9kdWNlciwgaXNQcm9kdWNlcldpdGhUcmFuc2l0aW9uLCBpc1ZhbGlkU3RyaW5nIH0gZnJvbSBcIi4uL3V0aWxzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VyaWFsaXplZFByb2R1Y2VyIHtcbiAgcHJvZHVjZXI6IHN0cmluZztcbiAgdHJhbnNpdGlvbj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXJpYWxpemVkQWN0aW9uIHtcbiAgYWN0aW9uOiBzdHJpbmc7XG4gIHN1Y2Nlc3M/OiBzdHJpbmcgfCBTZXJpYWxpemVkUHJvZHVjZXI7XG4gIGZhaWx1cmU/OiBzdHJpbmcgfCBTZXJpYWxpemVkUHJvZHVjZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VyaWFsaXplZEd1YXJkIHtcbiAgZ3VhcmQ6IHN0cmluZztcbiAgZmFpbHVyZT86IHN0cmluZyB8IFNlcmlhbGl6ZWRQcm9kdWNlcjtcbiAgbWFjaGluZT86IFNlcmlhbGl6ZWRNYWNoaW5lO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcmlhbGl6ZWRDb2xsZWN0aW9uIGV4dGVuZHMgQXJyYXk8U2VyaWFsaXplZEFjdGlvbiB8IFNlcmlhbGl6ZWRQcm9kdWNlcj4ge31cblxuZXhwb3J0IGludGVyZmFjZSBTZXJpYWxpemVkVHJhbnNpdGlvbiB7XG4gIHRhcmdldDogc3RyaW5nO1xuICBndWFyZHM/OiBTZXJpYWxpemVkR3VhcmRbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXJpYWxpemVkVHJhbnNpdGlvbnMge1xuICBba2V5OiBzdHJpbmddOiBTZXJpYWxpemVkVHJhbnNpdGlvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXJpYWxpemVkSW1tZWRpYXRlIHtcbiAgaW1tZWRpYXRlOiBzdHJpbmc7XG4gIGd1YXJkcz86IFNlcmlhbGl6ZWRHdWFyZFtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcmlhbGl6ZWRTdGF0ZSB7XG4gIG5hbWU6IHN0cmluZztcbiAgbmVzdGVkPzogU2VyaWFsaXplZE5lc3RlZE1hY2hpbmVbXTtcbiAgb24/OiBTZXJpYWxpemVkVHJhbnNpdGlvbnM7XG4gIHJ1bj86IFNlcmlhbGl6ZWRDb2xsZWN0aW9uO1xuICBpbW1lZGlhdGU/OiBTZXJpYWxpemVkSW1tZWRpYXRlW107XG4gIHR5cGU/OiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcmlhbGl6ZWRTdGF0ZXMge1xuICBba2V5OiBzdHJpbmddOiBTZXJpYWxpemVkU3RhdGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VyaWFsaXplZE1hY2hpbmUge1xuICB0aXRsZT86IHN0cmluZztcbiAgc3RhdGVzOiBTZXJpYWxpemVkU3RhdGVzO1xuICBwYXJhbGxlbDogUmVjb3JkPHN0cmluZywgU2VyaWFsaXplZE1hY2hpbmU+O1xuICBjb250ZXh0OiBhbnk7XG4gIGluaXRpYWw6IGFueTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZXJpYWxpemVkTmVzdGVkTWFjaGluZSB7XG4gIG1hY2hpbmU6IFNlcmlhbGl6ZWRNYWNoaW5lO1xuICB0cmFuc2l0aW9uPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIEBwYXJhbSBwcm9kdWNlciBUaGUgcHJvZHVjZXIgdG8gc2VyaWFsaXplXG4gKiBAcmV0dXJucyBTZXJpYWxpemVkUHJvZHVjZXJcbiAqL1xuZnVuY3Rpb24gc2VyaWFsaXplUHJvZHVjZXIocHJvZHVjZXI6IFByb2R1Y2VyRGlyZWN0aXZlKTogU2VyaWFsaXplZFByb2R1Y2VyIHtcbiAgbGV0IHNlcmlhbGl6ZWQ6IFNlcmlhbGl6ZWRQcm9kdWNlciA9IHtcbiAgICBwcm9kdWNlcjogcHJvZHVjZXIucHJvZHVjZXIubmFtZSxcbiAgfTtcblxuICBpZiAoaXNQcm9kdWNlcldpdGhUcmFuc2l0aW9uKHByb2R1Y2VyKSkge1xuICAgIHNlcmlhbGl6ZWQudHJhbnNpdGlvbiA9IHByb2R1Y2VyLnRyYW5zaXRpb247XG4gIH1cblxuICByZXR1cm4gc2VyaWFsaXplZDtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIGFjdGlvbiBUaGUgYWN0aW9uIHRvIHNlcmlhbGl6ZVxuICogQHJldHVybnMgU2VyaWFsaXplZEFjdGlvblxuICovXG5mdW5jdGlvbiBzZXJpYWxpemVBY3Rpb24oYWN0aW9uOiBBY3Rpb25EaXJlY3RpdmUpOiBTZXJpYWxpemVkQWN0aW9uIHtcbiAgbGV0IHNlcmlhbGl6ZWQ6IFNlcmlhbGl6ZWRBY3Rpb24gPSB7XG4gICAgYWN0aW9uOiBhY3Rpb24uYWN0aW9uLm5hbWUsXG4gIH07XG5cbiAgaWYgKGFjdGlvbi5zdWNjZXNzKSB7XG4gICAgaWYgKGlzVmFsaWRTdHJpbmcoYWN0aW9uLnN1Y2Nlc3MpKSB7XG4gICAgICBzZXJpYWxpemVkLnN1Y2Nlc3MgPSBhY3Rpb24uc3VjY2VzcztcbiAgICB9IGVsc2UgaWYgKGlzUHJvZHVjZXIoYWN0aW9uLnN1Y2Nlc3MpKSB7XG4gICAgICBzZXJpYWxpemVkLnN1Y2Nlc3MgPSBzZXJpYWxpemVQcm9kdWNlcihhY3Rpb24uc3VjY2Vzcyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGFjdGlvbi5mYWlsdXJlKSB7XG4gICAgaWYgKGlzVmFsaWRTdHJpbmcoYWN0aW9uLmZhaWx1cmUpKSB7XG4gICAgICBzZXJpYWxpemVkLmZhaWx1cmUgPSBhY3Rpb24uZmFpbHVyZTtcbiAgICB9IGVsc2UgaWYgKGlzUHJvZHVjZXIoYWN0aW9uLmZhaWx1cmUpKSB7XG4gICAgICBzZXJpYWxpemVkLmZhaWx1cmUgPSBzZXJpYWxpemVQcm9kdWNlcihhY3Rpb24uZmFpbHVyZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHNlcmlhbGl6ZWQ7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBndWFyZCBUaGUgZ3VhcmQgdG8gc2VyaWFsaXplXG4gKiBAcmV0dXJucyBTZXJpYWxpemVkR3VhcmRcbiAqL1xuZnVuY3Rpb24gc2VyaWFsaXplR3VhcmQoZ3VhcmQ6IEd1YXJkRGlyZWN0aXZlIHwgTmVzdGVkR3VhcmREaXJlY3RpdmUpOiBTZXJpYWxpemVkR3VhcmQge1xuICBsZXQgc2VyaWFsaXplZDogU2VyaWFsaXplZEd1YXJkID0ge1xuICAgIGd1YXJkOiBndWFyZC5ndWFyZC5uYW1lLFxuICB9O1xuXG4gIGlmIChpc1ZhbGlkU3RyaW5nKGd1YXJkLmZhaWx1cmUpKSB7XG4gICAgc2VyaWFsaXplZC5mYWlsdXJlID0gZ3VhcmQuZmFpbHVyZTtcbiAgfSBlbHNlIGlmIChpc1Byb2R1Y2VyKGd1YXJkLmZhaWx1cmUpKSB7XG4gICAgc2VyaWFsaXplZC5mYWlsdXJlID0gc2VyaWFsaXplUHJvZHVjZXIoZ3VhcmQuZmFpbHVyZSk7XG4gIH1cblxuICBpZiAoXCJtYWNoaW5lXCIgaW4gZ3VhcmQpIHtcbiAgICBzZXJpYWxpemVkLm1hY2hpbmUgPSBzZXJpYWxpemUoZ3VhcmQubWFjaGluZSk7XG4gIH1cblxuICByZXR1cm4gc2VyaWFsaXplZDtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIHJ1biBUaGUgcnVuIGNvbGxlY3Rpb24gdG8gc2VyaWFsaXplXG4gKiBAcmV0dXJucyBTZXJpYWxpemVkQ29sbGVjdGlvbiBvciBudWxsIGlmIGVtcHR5XG4gKi9cbmZ1bmN0aW9uIHNlcmlhbGl6ZVJ1bkFyZ3VtZW50cyhydW46IFJ1bkNvbGxlY3Rpb24pOiBTZXJpYWxpemVkQ29sbGVjdGlvbiB8IG51bGwge1xuICBpZiAoIUFycmF5LmlzQXJyYXkocnVuKSB8fCBydW4ubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gcnVuLm1hcCgoaXRlbSkgPT4ge1xuICAgIGlmIChpc0FjdGlvbihpdGVtKSkge1xuICAgICAgcmV0dXJuIHNlcmlhbGl6ZUFjdGlvbihpdGVtKTtcbiAgICB9XG5cbiAgICBpZiAoaXNQcm9kdWNlcihpdGVtKSkge1xuICAgICAgcmV0dXJuIHNlcmlhbGl6ZVByb2R1Y2VyKGl0ZW0pO1xuICAgIH1cbiAgfSkgYXMgU2VyaWFsaXplZENvbGxlY3Rpb247XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBndWFyZHMgVGhlIGd1YXJkcyB0byBzZXJpYWxpemVcbiAqIEByZXR1cm5zIFNlcmlhbGl6ZWRHdWFyZFtdIG9yIG51bGwgaWYgZW1wdHlcbiAqL1xuZnVuY3Rpb24gc2VyaWFsaXplR3VhcmRzKGd1YXJkczogR3VhcmRzRGlyZWN0aXZlKTogU2VyaWFsaXplZEd1YXJkW10gfCBudWxsIHtcbiAgaWYgKCFndWFyZHMgfHwgZ3VhcmRzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGd1YXJkcy5tYXAoKGd1YXJkKSA9PiBzZXJpYWxpemVHdWFyZChndWFyZCkpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0gdHJhbnNpdGlvbiBUaGUgdHJhbnNpdGlvbiB0byBzZXJpYWxpemVcbiAqIEByZXR1cm5zIFNlcmlhbGl6ZWRUcmFuc2l0aW9uXG4gKi9cbmZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zaXRpb24odHJhbnNpdGlvbjogVHJhbnNpdGlvbkRpcmVjdGl2ZSk6IFNlcmlhbGl6ZWRUcmFuc2l0aW9uIHtcbiAgbGV0IHNlcmlhbGl6ZWQ6IFNlcmlhbGl6ZWRUcmFuc2l0aW9uID0ge1xuICAgIHRhcmdldDogdHJhbnNpdGlvbi50YXJnZXQsXG4gIH07XG5cbiAgbGV0IGd1YXJkcyA9IHNlcmlhbGl6ZUd1YXJkcyh0cmFuc2l0aW9uLmd1YXJkcyk7XG5cbiAgaWYgKGd1YXJkcykge1xuICAgIHNlcmlhbGl6ZWQuZ3VhcmRzID0gZ3VhcmRzO1xuICB9XG5cbiAgcmV0dXJuIHNlcmlhbGl6ZWQ7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBpbW1lZGlhdGUgVGhlIGltbWVkaWF0ZSB0cmFuc2l0aW9uIHRvIHNlcmlhbGl6ZVxuICogQHJldHVybnMgU2VyaWFsaXplZEltbWVkaWF0ZVxuICovXG5mdW5jdGlvbiBzZXJpYWxpemVJbW1lZGlhdGUoaW1tZWRpYXRlOiBJbW1lZGlhdGVEaXJlY3RpdmUpOiBTZXJpYWxpemVkSW1tZWRpYXRlIHtcbiAgbGV0IHNlcmlhbGl6ZWQ6IFNlcmlhbGl6ZWRJbW1lZGlhdGUgPSB7XG4gICAgaW1tZWRpYXRlOiBpbW1lZGlhdGUuaW1tZWRpYXRlLFxuICB9O1xuXG4gIGxldCBndWFyZHMgPSBzZXJpYWxpemVHdWFyZHMoaW1tZWRpYXRlLmd1YXJkcyk7XG5cbiAgaWYgKGd1YXJkcykge1xuICAgIHNlcmlhbGl6ZWQuZ3VhcmRzID0gZ3VhcmRzO1xuICB9XG5cbiAgcmV0dXJuIHNlcmlhbGl6ZWQ7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBldmVudHMgVGhlIGV2ZW50cyB0byBzZXJpYWxpemVcbiAqIEByZXR1cm5zIFNlcmlhbGl6ZWRUcmFuc2l0aW9ucyBvciBudWxsIGlmIGVtcHR5XG4gKi9cbmZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zaXRpb25zKGV2ZW50czogVHJhbnNpdGlvbnNEaXJlY3RpdmUpOiBTZXJpYWxpemVkVHJhbnNpdGlvbnMgfCBudWxsIHtcbiAgaWYgKCFldmVudHMgfHwgT2JqZWN0LmtleXMoZXZlbnRzKS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGxldCBzZXJpYWxpemVkOiBTZXJpYWxpemVkVHJhbnNpdGlvbnMgPSB7fTtcbiAgZm9yIChsZXQgZXZlbnQgaW4gZXZlbnRzKSB7XG4gICAgc2VyaWFsaXplZFtldmVudF0gPSBzZXJpYWxpemVUcmFuc2l0aW9uKGV2ZW50c1tldmVudF0pO1xuICB9XG5cbiAgcmV0dXJuIHNlcmlhbGl6ZWQ7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBjb250ZXh0IFRoZSBjb250ZXh0IHRvIHNlcmlhbGl6ZVxuICogQHJldHVybnMgT2JqZWN0XG4gKi9cbmZ1bmN0aW9uIHNlcmlhbGl6ZUNvbnRleHQoY29udGV4dDogYW55KSB7XG4gIHJldHVybiBjbG9uZUNvbnRleHQoY29udGV4dCk7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBuZXN0ZWQgVGhlIG5lc3RlZCBtYWNoaW5lcyB0byBzZXJpYWxpemVcbiAqIEByZXR1cm5zIFNlcmlhbGl6ZWROZXN0ZWRNYWNoaW5lW10gb3IgbnVsbCBpZiBlbXB0eVxuICovXG5mdW5jdGlvbiBzZXJpYWxpemVOZXN0ZWQobmVzdGVkOiBOZXN0ZWRNYWNoaW5lRGlyZWN0aXZlW10pOiBTZXJpYWxpemVkTmVzdGVkTWFjaGluZVtdIHwgbnVsbCB7XG4gIGlmICghbmVzdGVkIHx8IG5lc3RlZC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBuZXN0ZWQubWFwKCh7IG1hY2hpbmUsIHRyYW5zaXRpb24gfSkgPT4ge1xuICAgIGxldCBzZXJpYWxpemVkTmVzdGVkTWFjaGluZTogU2VyaWFsaXplZE5lc3RlZE1hY2hpbmUgPSB7XG4gICAgICBtYWNoaW5lOiBzZXJpYWxpemUobWFjaGluZSksXG4gICAgfTtcblxuICAgIGlmICh0cmFuc2l0aW9uKSB7XG4gICAgICBzZXJpYWxpemVkTmVzdGVkTWFjaGluZS50cmFuc2l0aW9uID0gdHJhbnNpdGlvbjtcbiAgICB9XG5cbiAgICByZXR1cm4gc2VyaWFsaXplZE5lc3RlZE1hY2hpbmU7XG4gIH0pO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0gbWFjaGluZSBUaGUgbWFjaGluZSB0byBzZXJpYWxpemVcbiAqIEByZXR1cm5zIFNlcmlhbGl6ZWRNYWNoaW5lXG4gKiBAY2F0ZWdvcnkgU2VyaWFsaXphdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplKG1hY2hpbmU6IE1hY2hpbmUpOiBTZXJpYWxpemVkTWFjaGluZSB7XG4gIGxldCBzZXJpYWxpemVkOiBTZXJpYWxpemVkTWFjaGluZSA9IHtcbiAgICBzdGF0ZXM6IHt9LFxuICAgIHBhcmFsbGVsOiB7fSxcbiAgICBjb250ZXh0OiBzZXJpYWxpemVDb250ZXh0KG1hY2hpbmUuY29udGV4dCksXG4gICAgaW5pdGlhbDogbWFjaGluZS5pbml0aWFsLFxuICB9O1xuXG4gIGlmIChtYWNoaW5lLnRpdGxlKSB7XG4gICAgc2VyaWFsaXplZC50aXRsZSA9IG1hY2hpbmUudGl0bGU7XG4gIH1cblxuICBmb3IgKGxldCBzdGF0ZSBpbiBtYWNoaW5lLnN0YXRlcykge1xuICAgIHNlcmlhbGl6ZWQuc3RhdGVzW3N0YXRlXSA9IHt9IGFzIFNlcmlhbGl6ZWRTdGF0ZTtcblxuICAgIGxldCBuZXN0ZWQgPSBzZXJpYWxpemVOZXN0ZWQobWFjaGluZS5zdGF0ZXNbc3RhdGVdLm5lc3RlZCk7XG4gICAgaWYgKG5lc3RlZCkge1xuICAgICAgc2VyaWFsaXplZC5zdGF0ZXNbc3RhdGVdLm5lc3RlZCA9IG5lc3RlZDtcbiAgICB9XG5cbiAgICBsZXQgcnVuID0gc2VyaWFsaXplUnVuQXJndW1lbnRzKG1hY2hpbmUuc3RhdGVzW3N0YXRlXS5ydW4pO1xuICAgIGlmIChydW4pIHtcbiAgICAgIHNlcmlhbGl6ZWQuc3RhdGVzW3N0YXRlXS5ydW4gPSBydW47XG4gICAgfVxuXG4gICAgbGV0IG9uID0gc2VyaWFsaXplVHJhbnNpdGlvbnMobWFjaGluZS5zdGF0ZXNbc3RhdGVdLm9uKTtcbiAgICBpZiAob24pIHtcbiAgICAgIHNlcmlhbGl6ZWQuc3RhdGVzW3N0YXRlXS5vbiA9IG9uO1xuICAgIH1cblxuICAgIGxldCBpbW1lZGlhdGUgPSBtYWNoaW5lLnN0YXRlc1tzdGF0ZV0uaW1tZWRpYXRlO1xuICAgIGlmIChpbW1lZGlhdGUubGVuZ3RoKSB7XG4gICAgICBsZXQgc2VyaWFsaXplZEltbWVkaWF0ZTogU2VyaWFsaXplZEltbWVkaWF0ZVtdID0gW107XG4gICAgICBmb3IgKGxldCBpbW1lZGlhdGVEaXJlY3RpdmUgb2YgaW1tZWRpYXRlKSB7XG4gICAgICAgIHNlcmlhbGl6ZWRJbW1lZGlhdGUucHVzaChzZXJpYWxpemVJbW1lZGlhdGUoaW1tZWRpYXRlRGlyZWN0aXZlKSk7XG4gICAgICB9XG4gICAgICBzZXJpYWxpemVkLnN0YXRlc1tzdGF0ZV0uaW1tZWRpYXRlID0gc2VyaWFsaXplZEltbWVkaWF0ZTtcbiAgICB9XG5cbiAgICBpZiAoaXNWYWxpZFN0cmluZyhtYWNoaW5lLnN0YXRlc1tzdGF0ZV0udHlwZSkpIHtcbiAgICAgIHNlcmlhbGl6ZWQuc3RhdGVzW3N0YXRlXS50eXBlID0gbWFjaGluZS5zdGF0ZXNbc3RhdGVdLnR5cGU7XG4gICAgfVxuXG4gICAgaWYgKGlzVmFsaWRTdHJpbmcobWFjaGluZS5zdGF0ZXNbc3RhdGVdLmRlc2NyaXB0aW9uKSkge1xuICAgICAgc2VyaWFsaXplZC5zdGF0ZXNbc3RhdGVdLmRlc2NyaXB0aW9uID0gbWFjaGluZS5zdGF0ZXNbc3RhdGVdLmRlc2NyaXB0aW9uO1xuICAgIH1cbiAgfVxuXG4gIGZvciAobGV0IHBhcmFsbGVsIGluIG1hY2hpbmUucGFyYWxsZWwpIHtcbiAgICBzZXJpYWxpemVkLnBhcmFsbGVsW3BhcmFsbGVsXSA9IHNlcmlhbGl6ZShtYWNoaW5lLnBhcmFsbGVsW3BhcmFsbGVsXSk7XG4gIH1cblxuICByZXR1cm4gc2VyaWFsaXplZDtcbn1cbiIsIi8qKiBAbW9kdWxlIHgtcm9ib3QvdXRpbHMgKi9cbmltcG9ydCB7XG4gIEFjdGlvbkRpcmVjdGl2ZSxcbiAgQ29udGV4dERpcmVjdGl2ZSxcbiAgRGVzY3JpcHRpb25EaXJlY3RpdmUsXG4gIEd1YXJkRGlyZWN0aXZlLFxuICBJbW1lZGlhdGVEaXJlY3RpdmUsXG4gIEluaXRpYWxEaXJlY3RpdmUsXG4gIE1hY2hpbmUsXG4gIE5lc3RlZEd1YXJkRGlyZWN0aXZlLFxuICBOZXN0ZWRJbW1lZGlhdGVEaXJlY3RpdmUsXG4gIE5lc3RlZE1hY2hpbmVEaXJlY3RpdmUsXG4gIE5lc3RlZE1hY2hpbmVXaXRoVHJhbnNpdGlvbkRpcmVjdGl2ZSxcbiAgUGFyYWxsZWxEaXJlY3RpdmUsXG4gIFBhcmFsbGVsSW1tZWRpYXRlRGlyZWN0aXZlLFxuICBQcm9kdWNlckRpcmVjdGl2ZSxcbiAgUHJvZHVjZXJEaXJlY3RpdmVXaXRoVHJhbnNpdGlvbixcbiAgUHJvZHVjZXJEaXJlY3RpdmVXaXRob3V0VHJhbnNpdGlvbixcbiAgU1RBUlRfRVZFTlQsXG4gIFNob3VsZEZyZWV6ZURpcmVjdGl2ZSxcbiAgU3RhdGVEaXJlY3RpdmUsXG4gIFN0YXRlc0RpcmVjdGl2ZSxcbiAgVHJhbnNpdGlvbkRpcmVjdGl2ZVxufSBmcm9tIFwiLi9tYWNoaW5lL2ludGVyZmFjZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRTdHJpbmcoc3RyPzogYW55KTogc3RyIGlzIHN0cmluZyB7XG4gIHJldHVybiBzdHIgIT09IG51bGwgJiYgdHlwZW9mIHN0ciA9PT0gXCJzdHJpbmdcIiAmJiBzdHIudHJpbSgpLmxlbmd0aCA+IDA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkT2JqZWN0KG9iajogYW55KTogb2JqIGlzIG9iamVjdCB7XG4gIHJldHVybiBvYmogIT09IG51bGwgJiYgdHlwZW9mIG9iaiA9PT0gXCJvYmplY3RcIjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUHJvZHVjZXIocHJvZHVjZXI/OiBhbnkpOiBwcm9kdWNlciBpcyBQcm9kdWNlckRpcmVjdGl2ZSB7XG4gIHJldHVybiBpc1ZhbGlkT2JqZWN0KHByb2R1Y2VyKSAmJiBcInByb2R1Y2VyXCIgaW4gcHJvZHVjZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb2R1Y2VyV2l0aFRyYW5zaXRpb24oXG4gIHByb2R1Y2VyPzogYW55XG4pOiBwcm9kdWNlciBpcyBQcm9kdWNlckRpcmVjdGl2ZVdpdGhUcmFuc2l0aW9uIHtcbiAgcmV0dXJuIGlzUHJvZHVjZXIocHJvZHVjZXIpICYmIGlzVmFsaWRTdHJpbmcocHJvZHVjZXIudHJhbnNpdGlvbik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb2R1Y2VyV2l0aG91dFRyYW5zaXRpb24oXG4gIHByb2R1Y2VyPzogYW55XG4pOiBwcm9kdWNlciBpcyBQcm9kdWNlckRpcmVjdGl2ZVdpdGhvdXRUcmFuc2l0aW9uIHtcbiAgcmV0dXJuICFpc1Byb2R1Y2VyV2l0aFRyYW5zaXRpb24ocHJvZHVjZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNBY3Rpb24oYWN0aW9uPzogYW55KTogYWN0aW9uIGlzIEFjdGlvbkRpcmVjdGl2ZSB7XG4gIHJldHVybiBpc1ZhbGlkT2JqZWN0KGFjdGlvbikgJiYgXCJhY3Rpb25cIiBpbiBhY3Rpb247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0ltbWVkaWF0ZShpbW1lZGlhdGU/OiBhbnkpOiBpbW1lZGlhdGUgaXMgSW1tZWRpYXRlRGlyZWN0aXZlIHtcbiAgcmV0dXJuIGlzVmFsaWRPYmplY3QoaW1tZWRpYXRlKSAmJiBcImltbWVkaWF0ZVwiIGluIGltbWVkaWF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzR3VhcmQoZ3VhcmQ/OiBhbnkpOiBndWFyZCBpcyBHdWFyZERpcmVjdGl2ZSB7XG4gIHJldHVybiBpc1ZhbGlkT2JqZWN0KGd1YXJkKSAmJiBcImd1YXJkXCIgaW4gZ3VhcmQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc05lc3RlZEd1YXJkKGd1YXJkPzogYW55KTogZ3VhcmQgaXMgTmVzdGVkR3VhcmREaXJlY3RpdmUge1xuICByZXR1cm4gaXNHdWFyZChndWFyZCkgJiYgXCJtYWNoaW5lXCIgaW4gZ3VhcmQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1RyYW5zaXRpb24oXG4gIHRyYW5zaXRpb24/OiBhbnlcbik6IHRyYW5zaXRpb24gaXMgVHJhbnNpdGlvbkRpcmVjdGl2ZSB7XG4gIHJldHVybiAoXG4gICAgaXNWYWxpZE9iamVjdCh0cmFuc2l0aW9uKSAmJlxuICAgIFwidHJhbnNpdGlvblwiIGluIHRyYW5zaXRpb24gJiZcbiAgICBcInRhcmdldFwiIGluIHRyYW5zaXRpb25cbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1RyYW5zaXRpb24oXG4gIHN0YXRlOiBTdGF0ZURpcmVjdGl2ZSxcbiAgdHJhbnNpdGlvbjogc3RyaW5nXG4pOiBib29sZWFuIHtcbiAgcmV0dXJuIGlzVmFsaWRTdHJpbmcodHJhbnNpdGlvbikgJiYgdHJhbnNpdGlvbiBpbiBzdGF0ZS5vbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1N0YXRlKG1hY2hpbmU6IE1hY2hpbmUsIHN0YXRlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIGlzVmFsaWRTdHJpbmcoc3RhdGUpICYmIHN0YXRlIGluIG1hY2hpbmUuc3RhdGVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOZXN0ZWRNYWNoaW5lRGlyZWN0aXZlKFxuICBtYWNoaW5lPzogYW55XG4pOiBtYWNoaW5lIGlzIE5lc3RlZE1hY2hpbmVEaXJlY3RpdmUge1xuICByZXR1cm4gaXNWYWxpZE9iamVjdChtYWNoaW5lKSAmJiBcIm1hY2hpbmVcIiBpbiBtYWNoaW5lO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOZXN0ZWRNYWNoaW5lV2l0aFRyYW5zaXRpb25EaXJlY3RpdmUoXG4gIG1hY2hpbmU/OiBhbnlcbik6IG1hY2hpbmUgaXMgTmVzdGVkTWFjaGluZVdpdGhUcmFuc2l0aW9uRGlyZWN0aXZlIHtcbiAgcmV0dXJuIGlzTmVzdGVkTWFjaGluZURpcmVjdGl2ZShtYWNoaW5lKSAmJiBpc1ZhbGlkU3RyaW5nKG1hY2hpbmUudHJhbnNpdGlvbik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc01hY2hpbmUobWFjaGluZT86IGFueSk6IG1hY2hpbmUgaXMgTWFjaGluZSB7XG4gIHJldHVybiAoXG4gICAgaXNWYWxpZE9iamVjdChtYWNoaW5lKSAmJlxuICAgIFwic3RhdGVzXCIgaW4gbWFjaGluZSAmJlxuICAgIFwiaW5pdGlhbFwiIGluIG1hY2hpbmUgJiZcbiAgICBcImN1cnJlbnRcIiBpbiBtYWNoaW5lXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1N0YXRlRGlyZWN0aXZlKHN0YXRlPzogYW55KTogc3RhdGUgaXMgU3RhdGVEaXJlY3RpdmUge1xuICByZXR1cm4gKFxuICAgIGlzVmFsaWRPYmplY3Qoc3RhdGUpICYmXG4gICAgXCJuYW1lXCIgaW4gc3RhdGUgJiZcbiAgICBcInJ1blwiIGluIHN0YXRlICYmXG4gICAgXCJvblwiIGluIHN0YXRlICYmXG4gICAgXCJhcmdzXCIgaW4gc3RhdGVcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29udGV4dERpcmVjdGl2ZShjb250ZXh0PzogYW55KTogY29udGV4dCBpcyBDb250ZXh0RGlyZWN0aXZlIHtcbiAgcmV0dXJuIGlzVmFsaWRPYmplY3QoY29udGV4dCkgJiYgXCJjb250ZXh0XCIgaW4gY29udGV4dDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3RhdGVzRGlyZWN0aXZlKHN0YXRlcz86IGFueSk6IHN0YXRlcyBpcyBTdGF0ZXNEaXJlY3RpdmUge1xuICByZXR1cm4gKFxuICAgIGlzVmFsaWRPYmplY3Qoc3RhdGVzKSAmJlxuICAgIE9iamVjdC5rZXlzKHN0YXRlcykuZXZlcnkoKGtleSkgPT4gaXNWYWxpZFN0cmluZyhrZXkpKSAmJlxuICAgIE9iamVjdC52YWx1ZXMoc3RhdGVzKS5ldmVyeSgoc3RhdGUpID0+IGlzU3RhdGVEaXJlY3RpdmUoc3RhdGUpKVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNQYXJhbGxlbERpcmVjdGl2ZShcbiAgcGFyYWxsZWw/OiBhbnlcbik6IHBhcmFsbGVsIGlzIFBhcmFsbGVsRGlyZWN0aXZlIHtcbiAgcmV0dXJuIGlzVmFsaWRPYmplY3QocGFyYWxsZWwpICYmIFwicGFyYWxsZWxcIiBpbiBwYXJhbGxlbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2hvdWxkRnJlZXplRGlyZWN0aXZlKFxuICBzaG91bGRGcmVlemU/OiBhbnlcbik6IHNob3VsZEZyZWV6ZSBpcyBTaG91bGRGcmVlemVEaXJlY3RpdmUge1xuICByZXR1cm4gaXNWYWxpZE9iamVjdChzaG91bGRGcmVlemUpICYmIFwiZnJlZXplXCIgaW4gc2hvdWxkRnJlZXplO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNJbml0aWFsRGlyZWN0aXZlKGluaXRpYWw/OiBhbnkpOiBpbml0aWFsIGlzIEluaXRpYWxEaXJlY3RpdmUge1xuICByZXR1cm4gaXNWYWxpZE9iamVjdChpbml0aWFsKSAmJiBcImluaXRpYWxcIiBpbiBpbml0aWFsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNEZXNjcmlwdGlvbkRpcmVjdGl2ZShcbiAgZGVzY3JpcHRpb24/OiBhbnlcbik6IGRlc2NyaXB0aW9uIGlzIERlc2NyaXB0aW9uRGlyZWN0aXZlIHtcbiAgcmV0dXJuIGlzVmFsaWRPYmplY3QoZGVzY3JpcHRpb24pICYmIFwiZGVzY3JpcHRpb25cIiBpbiBkZXNjcmlwdGlvbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTmVzdGVkVHJhbnNpdGlvbih0cmFuc2l0aW9uPzogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiBpc1ZhbGlkU3RyaW5nKHRyYW5zaXRpb24pICYmIC9eXFx3K1xcLi4rJC9naS50ZXN0KHRyYW5zaXRpb24pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNQYXJhbGxlbFRyYW5zaXRpb24odHJhbnNpdGlvbj86IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gaXNWYWxpZFN0cmluZyh0cmFuc2l0aW9uKSAmJiAvXlxcdytcXC8uKyQvZ2kudGVzdCh0cmFuc2l0aW9uKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTmVzdGVkSW1tZWRpYXRlRGlyZWN0aXZlKFxuICBpbW1lZGlhdGU/OiBhbnlcbik6IGltbWVkaWF0ZSBpcyBOZXN0ZWRJbW1lZGlhdGVEaXJlY3RpdmUge1xuICByZXR1cm4gaXNJbW1lZGlhdGUoaW1tZWRpYXRlKSAmJiBpc05lc3RlZFRyYW5zaXRpb24oaW1tZWRpYXRlLmltbWVkaWF0ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1BhcmFsbGVsSW1tZWRpYXRlRGlyZWN0aXZlKFxuICBpbW1lZGlhdGU/OiBhbnlcbik6IGltbWVkaWF0ZSBpcyBQYXJhbGxlbEltbWVkaWF0ZURpcmVjdGl2ZSB7XG4gIHJldHVybiBpc0ltbWVkaWF0ZShpbW1lZGlhdGUpICYmIGlzUGFyYWxsZWxUcmFuc2l0aW9uKGltbWVkaWF0ZS5pbW1lZGlhdGUpO1xufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gZGVlcCBmcmVlemUgYW4gb2JqZWN0XG4gKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gZnJlZXplXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBPYmplY3QgZnJvemVuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWVwRnJlZXplKG9iajogYW55KSB7XG4gIGlmICh0eXBlb2Ygb2JqID09PSBcIm9iamVjdFwiICYmIG9iaiAhPT0gbnVsbCAmJiAhT2JqZWN0LmlzRnJvemVuKG9iaikpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgICBmb3IgKGxldCBpID0gMCwgbCA9IG9iai5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgZGVlcEZyZWV6ZShvYmpbaV0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGxldCBwcm9wIGluIG9iaikge1xuICAgICAgICBkZWVwRnJlZXplKG9ialtwcm9wXSk7XG4gICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5mcmVlemUob2JqKTtcbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG5cbi8vIENyZWF0ZXMgYSBkZWVwIGNvcHkgb2YgdGhlIGNvbnRleHRcbi8vIEBwYXJhbSB7T2JqZWN0fSBjb250ZXh0XG4vLyBAcmV0dXJucyB7T2JqZWN0fVxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lQ29udGV4dChjb250ZXh0OiBhbnksIHdlYWtNYXAgPSBuZXcgV2Vha01hcCgpKTogYW55IHtcbiAgLy8gSWYgY29udGV4dCBpcyBpbiB0aGUgd2VhayBtYXAsIHdlIHdpbGwgdXNlIHRoZSB3ZWFrIG1hcCB2YWx1ZVxuICBpZiAod2Vha01hcC5oYXMoY29udGV4dCkpIHtcbiAgICByZXR1cm4gd2Vha01hcC5nZXQoY29udGV4dCk7XG4gIH1cblxuICAvLyBJZiBjb250ZXh0IGlzIG51bGwgb3IgdW5kZWZpbmVkLCB3ZSB3aWxsIHJldHVybiBpdCBhcyBpc1xuICBpZiAoY29udGV4dCA9PT0gbnVsbCB8fCBjb250ZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gY29udGV4dDtcbiAgfVxuXG4gIGxldCByZXN1bHQ7XG5cbiAgLy8gQ2hlY2sgZm9yIGV2ZXJ5IHR5cGUgb2Ygb2JqZWN0IHByb3BlcnR5IGFuZCBjbG9uZSBpdCBhY2NvcmRpbmdseVxuICAvLyBJZiBpcyBhbiBhcnJheSwgd2Ugd2lsbCBjbG9uZSBpdCByZWN1cnNpdmVseVxuICBpZiAoQXJyYXkuaXNBcnJheShjb250ZXh0KSkge1xuICAgIHJlc3VsdCA9IGNvbnRleHQubWFwKChpdGVtKSA9PiBjbG9uZUNvbnRleHQoaXRlbSwgd2Vha01hcCkpO1xuICB9XG5cbiAgLy8gSWYgaXQgaXMgYW4gb2JqZWN0LCB3ZSB3aWxsIGNsb25lIGl0IHJlY3Vyc2l2ZWx5XG4gIGVsc2UgaWYgKHR5cGVvZiBjb250ZXh0ID09PSBcIm9iamVjdFwiKSB7XG4gICAgcmVzdWx0ID0ge30gYXMgYW55O1xuICAgIGZvciAobGV0IGtleSBpbiBjb250ZXh0KSB7XG4gICAgICByZXN1bHRba2V5XSA9IGNsb25lQ29udGV4dChjb250ZXh0W2tleV0sIHdlYWtNYXApO1xuICAgIH1cbiAgfVxuXG4gIC8vIElmIGl0IGlzIGEgZGF0ZSwgd2Ugd2lsbCBjbG9uZSBpdFxuICBlbHNlIGlmIChjb250ZXh0IGluc3RhbmNlb2YgRGF0ZSkge1xuICAgIHJlc3VsdCA9IG5ldyBEYXRlKGNvbnRleHQuZ2V0VGltZSgpKTtcbiAgfVxuXG4gIC8vIElmIGl0IGlzIGEgU2V0LCB3ZSB3aWxsIGNsb25lIGl0IHJlY3Vyc2l2ZWx5XG4gIGVsc2UgaWYgKGNvbnRleHQgaW5zdGFuY2VvZiBTZXQpIHtcbiAgICByZXN1bHQgPSBuZXcgU2V0KGNvbnRleHQpO1xuICB9XG5cbiAgLy8gSWYgaXQgaXMgYSBNYXAsIHdlIHdpbGwgY2xvbmUgaXQgcmVjdXJzaXZlbHlcbiAgZWxzZSBpZiAoY29udGV4dCBpbnN0YW5jZW9mIE1hcCkge1xuICAgIGxldCBhcnJheSA9IEFycmF5LmZyb20oY29udGV4dCwgKFtrZXksIHZhbF0pID0+IFtcbiAgICAgIGtleSxcbiAgICAgIGNsb25lQ29udGV4dCh2YWwsIHdlYWtNYXApXG4gICAgXSkgYXMgW2FueSwgYW55XVtdO1xuICAgIHJlc3VsdCA9IG5ldyBNYXAoYXJyYXkpO1xuICB9XG5cbiAgLy8gSWYgaXQgaXMgYSBSZWdFeHAsIHdlIHdpbGwgY2xvbmUgaXRcbiAgZWxzZSBpZiAoY29udGV4dCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgIHJldHVybiBuZXcgUmVnRXhwKGNvbnRleHQuc291cmNlLCBjb250ZXh0LmZsYWdzKTtcbiAgfVxuXG4gIC8vIElmIGl0IGlzIGEgaW5zdGFuY2Ugb2YgYSBjbGFzcywgd2UgY3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBjbGFzc1xuICAvLyBPbmx5IGlmIHdlIHR1cm4gdGhlIGZpcnN0IHBhcmFtZXRlciB0byB0cnVlXG4gIGVsc2UgaWYgKGZhbHNlICYmIGNvbnRleHQgaW5zdGFuY2VvZiBPYmplY3QgJiYgY29udGV4dC5jb25zdHJ1Y3Rvcikge1xuICAgIHJlc3VsdCA9IG5ldyBjb250ZXh0LmNvbnN0cnVjdG9yKGNvbnRleHQpO1xuICB9XG5cbiAgLy8gSWYgaXQgaXMgYSBwcmltaXRpdmUsIHdlIHdpbGwganVzdCBhc3NpZ24gaXRcbiAgZWxzZSB7XG4gICAgcmVzdWx0ID0gY29udGV4dDtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLy8gQWRkIHRoZSBjb250ZXh0IHRvIHRoZSB3ZWFrIG1hcFxuICB3ZWFrTWFwLnNldChjb250ZXh0LCByZXN1bHQpO1xuXG4gIC8vIFJldHVybiB0aGUgY2xvbmVkIGNvbnRleHRcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gVGhpcyBtZXRob2QgYWxsb3dzIHRvIGdldCBhIHZhbHVlIGZyb20gYSBwYXNzZWQgb2JqZWN0IHVzaW5nIGRvdCBub3RhdGlvbiBwYXRoLCBpdCBpcyBub3QgdXNlZCBpbiB0aGUgbGlicmFyeSBhdCB0aGUgbW9tZW50XG5mdW5jdGlvbiBnZXRQcm9wZXJ0eShcbiAgb2JqOiBSZWNvcmQ8c3RyaW5nIHwgbnVtYmVyIHwgc3ltYm9sLCBhbnk+LFxuICBwcm9wZXJ0eTogc3RyaW5nLFxuICBkZWZhdWx0VmFsdWU/OiBhbnlcbik6IGFueSB7XG4gIGxldCByZXN1bHQgPSBvYmo7XG5cbiAgaWYgKHR5cGVvZiBwcm9wZXJ0eSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5IGlzIHVuZGVmaW5lZFwiKTtcbiAgfVxuXG4gIGxldCBwYXJzZWQgPSBwcm9wZXJ0eS5zcGxpdChcIi5cIik7XG4gIGxldCBuZXh0O1xuXG4gIHdoaWxlIChwYXJzZWQubGVuZ3RoKSB7XG4gICAgbmV4dCA9IHBhcnNlZC5zaGlmdCgpO1xuXG4gICAgaWYgKHR5cGVvZiBuZXh0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZiAobmV4dC5pbmRleE9mKFwiW1wiKSA+IC0xKSB7XG4gICAgICBsZXQgaWR4ID0gbmV4dC5yZXBsYWNlKC9cXEQvZ2ksIFwiXCIpO1xuICAgICAgbmV4dCA9IG5leHQuc3BsaXQoXCJbXCIpWzBdO1xuICAgICAgcGFyc2VkLnVuc2hpZnQoaWR4KTtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICBuZXh0IGluIHJlc3VsdCA9PT0gZmFsc2UgfHxcbiAgICAgIChwYXJzZWQubGVuZ3RoID4gMCAmJiB0eXBlb2YgcmVzdWx0W25leHRdICE9PSBcIm9iamVjdFwiKVxuICAgICkge1xuICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICB9XG5cbiAgICByZXN1bHQgPSByZXN1bHRbbmV4dF07XG4gIH1cblxuICByZXR1cm4gdHlwZW9mIHJlc3VsdCA9PT0gXCJ1bmRlZmluZWRcIiA/IGRlZmF1bHRWYWx1ZSA6IHJlc3VsdDtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIG1hY2hpbmUgVGhlIG1hY2hpbmUgdGhhdCBpcyBjdXJyZW50bHkgcnVubmluZ1xuICogQHBhcmFtIGN1cnJlbnRTdGF0ZU9iamVjdCBUaGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgbWFjaGluZVxuICogQHBhcmFtIHRyYW5zaXRpb24gVGhlIHRyYW5zaXRpb24gdGhhdCB3ZSB3YW50IHRvIGV4ZWN1dGVcbiAqIEByZXR1cm5zIGJvb2xlYW4gdHJ1ZSBpZiB0aGUgdHJhbnNpdGlvbiBjYW4gYmUgZXhlY3V0ZWQsIGZhbHNlIG90aGVyd2lzZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FuTWFrZVRyYW5zaXRpb24oXG4gIG1hY2hpbmU6IE1hY2hpbmUsXG4gIGN1cnJlbnRTdGF0ZU9iamVjdDogU3RhdGVEaXJlY3RpdmUsXG4gIHRyYW5zaXRpb246IHN0cmluZ1xuKTogYm9vbGVhbiB7XG4gIGlmICghaXNWYWxpZFN0cmluZyh0cmFuc2l0aW9uKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB0cmFuc2l0aW9uOiAke3RyYW5zaXRpb259YCk7XG4gIH1cblxuICBsZXQgdHJpbW1lZFRyYW5zaXRpb24gPSB0cmFuc2l0aW9uLnRyaW0oKTtcblxuICAvLyBJZiB0aGUgdHJhbnNpdGlvbiBpcyB0aGUgU1RBUlRfRVZFTlQgd2Ugd2lsbCByZXR1cm4gdHJ1ZSBpZiB0aGUgY3VycmVudCBzdGF0ZSBpcyB0aGUgaW5pdGlhbCBzdGF0ZSBhbmQgd2UgaGF2ZSBubyBoaXN0b3J5XG4gIGlmICh0cmltbWVkVHJhbnNpdGlvbiA9PT0gU1RBUlRfRVZFTlQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgY3VycmVudFN0YXRlT2JqZWN0Lm5hbWUgPT09IG1hY2hpbmUuaW5pdGlhbCAmJlxuICAgICAgbWFjaGluZS5oaXN0b3J5Lmxlbmd0aCA9PT0gMVxuICAgICk7XG4gIH1cblxuICAvLyBDaGVjayBpZiB3ZSBoYXZlIGEgbm9ybWFsIHRyYW5zaXRpb24gb3IgYSBuZXN0ZWQgdHJhbnNpdGlvbiAobmVzdGVkIHRyYW5zaXRpb25zIGFyZSBkb3Qgc2VwYXJhdGVkKVxuICBpZiAoXG4gICAgaXNOZXN0ZWRUcmFuc2l0aW9uKHRyaW1tZWRUcmFuc2l0aW9uKSB8fFxuICAgIGlzUGFyYWxsZWxUcmFuc2l0aW9uKHRyaW1tZWRUcmFuc2l0aW9uKVxuICApIHtcbiAgICAvLyBHZXQgdGhlIG5lc3RlZCB0cmFuc2l0aW9uIHBhcnRzXG4gICAgbGV0IHRyYW5zaXRpb25QYXJ0cyA9IGlzTmVzdGVkVHJhbnNpdGlvbih0cmltbWVkVHJhbnNpdGlvbilcbiAgICAgID8gdHJpbW1lZFRyYW5zaXRpb24uc3BsaXQoXCIuXCIpXG4gICAgICA6IHRyaW1tZWRUcmFuc2l0aW9uLnNwbGl0KFwiL1wiKTtcbiAgICAvLyBUaGUgZmlyc3QgcGFydCBtdXN0IGJlIHRoZSBjdXJyZW50IHN0YXRlXG4gICAgbGV0IHN0YXRlTmFtZSA9IHRyYW5zaXRpb25QYXJ0cy5zaGlmdCgpO1xuICAgIC8vIFRoZSBzZWNvbmQgcGFydCBtdXN0IGJlIHRoZSB0cmFuc2l0aW9uXG4gICAgbGV0IHRyYW5zaXRpb25OYW1lID0gaXNOZXN0ZWRUcmFuc2l0aW9uKHRyaW1tZWRUcmFuc2l0aW9uKVxuICAgICAgPyB0cmFuc2l0aW9uUGFydHMuam9pbihcIi5cIilcbiAgICAgIDogdHJhbnNpdGlvblBhcnRzLmpvaW4oXCIvXCIpO1xuXG4gICAgLy8gSWYgd2UgaGF2ZSBubyBzdGF0ZU5hbWUsIHdlIGNhbid0IG1ha2UgYSB0cmFuc2l0aW9uXG4gICAgaWYgKCFzdGF0ZU5hbWUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgc3RhdGVOYW1lIGlzIGluIHRoZSBwYXJhbGxlbCBvYmplY3QgY2hlY2sgaWYgd2UgY2FuIG1ha2UgdGhlIHRyYW5zaXRpb24gaW4gdGhlIHBhcmFsbGVsIG1hY2hpbmVcbiAgICBpZiAoc3RhdGVOYW1lIGluIG1hY2hpbmUucGFyYWxsZWwpIHtcbiAgICAgIGxldCBwYXJhbGxlbE1hY2hpbmUgPSBtYWNoaW5lLnBhcmFsbGVsW3N0YXRlTmFtZV07XG4gICAgICByZXR1cm4gY2FuTWFrZVRyYW5zaXRpb24oXG4gICAgICAgIHBhcmFsbGVsTWFjaGluZSxcbiAgICAgICAgcGFyYWxsZWxNYWNoaW5lLnN0YXRlc1twYXJhbGxlbE1hY2hpbmUuY3VycmVudF0sXG4gICAgICAgIHRyYW5zaXRpb25OYW1lXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIElmIHRoZSBjdXJyZW50IHN0YXRlIG5hbWUgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSBzdGF0ZU5hbWUgcmV0dXJuIGZhbHNlXG4gICAgaWYgKHN0YXRlTmFtZSAhPT0gY3VycmVudFN0YXRlT2JqZWN0Lm5hbWUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgY3VycmVudCBzdGF0ZSBkb2Vzbid0IGhhdmUgYSBuZXN0ZWQgbWFjaGluZSByZXR1cm4gZmFsc2VcbiAgICBpZiAoY3VycmVudFN0YXRlT2JqZWN0Lm5lc3RlZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBXZSBsb29wIHRocm91Z2ggdGhlIG5lc3RlZCBtYWNoaW5lcyBhbmQgY2hlY2sgaWYgd2UgY2FuIG1ha2UgdGhlIHRyYW5zaXRpb25cbiAgICBmb3IgKGxldCBuZXN0ZWRNYWNoaW5lIG9mIGN1cnJlbnRTdGF0ZU9iamVjdC5uZXN0ZWQpIHtcbiAgICAgIGlmIChcbiAgICAgICAgY2FuTWFrZVRyYW5zaXRpb24oXG4gICAgICAgICAgbmVzdGVkTWFjaGluZS5tYWNoaW5lLFxuICAgICAgICAgIG5lc3RlZE1hY2hpbmUubWFjaGluZS5zdGF0ZXNbbmVzdGVkTWFjaGluZS5tYWNoaW5lLmN1cnJlbnRdLFxuICAgICAgICAgIHRyYW5zaXRpb25OYW1lXG4gICAgICAgIClcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBJZiB3ZSBnZXQgaGVyZSwgd2UgaGF2ZSBhIG5vcm1hbCB0cmFuc2l0aW9uXG4gIHJldHVybiBoYXNUcmFuc2l0aW9uKGN1cnJlbnRTdGF0ZU9iamVjdCwgdHJpbW1lZFRyYW5zaXRpb24pO1xufVxuXG5leHBvcnQgY29uc3QgdGl0bGVUb0lkID0gKHN0cjogc3RyaW5nKSA9PlxuICBzdHIudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC8oXFxzfFxcVykvZywgXCJcIik7XG4iXSwibWFwcGluZ3MiOiJnSkFBQUEsRUFBQSxHLHlEQUFBQyxDQUFBRCxFQUFBLENBQUFFLFVBQUEsSUFBQUEsSUFBQSxJLEVBQUFDLEcsRUFBQUgsRSwwTUN5Qk8sU0FBQUksRUFBdUJDLEdBQzVCLE9BQWUsT0FBUkEsR0FBK0IsaUJBQVJBLEdBQW9CQSxFQUFJQyxPQUFPQyxPQUFTLEVBR2pFLFNBQUFDLEVBQXVCQyxHQUM1QixPQUFlLE9BQVJBLEdBQStCLGlCQUFSQSxFQUd6QixTQUFBQyxFQUFvQkMsR0FDekIsT0FBT0gsRUFBY0csSUFBYSxhQUFjQSxFQWtLM0MsU0FBQUMs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